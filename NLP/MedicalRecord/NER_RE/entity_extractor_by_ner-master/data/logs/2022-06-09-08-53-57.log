2022-06-09 08:53:57
++++++++++++++++++++++++++++++++++++++++CONFIGURATION SUMMARY++++++++++++++++++++++++++++++++++++++++
 Status:
     mode                 : train
 ++++++++++++++++++++++++++++++++++++++++
 Datasets:
     datasets         fold: data
     train            file: train.txt
     validation       file: None
     vocab             dir: data/vocabs
     delimiter            : b
     use  pretrained model: True
     pretrained      model: Bert
     finetune             : False
     use    middle   model: True
     middle          model: bilstm
     checkpoints       dir: ckpts/bert-bilstm-crf
     log               dir: data/logs
 ++++++++++++++++++++++++++++++++++++++++
Labeling Scheme:
     label          scheme: BIO
     label           level: 2
     suffixes             : ['Symptom', 'Physiology', 'Status', 'Property', 'Body', 'Value']
     measuring     metrics: ['precision', 'recall', 'f1', 'accuracy']
 ++++++++++++++++++++++++++++++++++++++++
Model Configuration:
     embedding         dim: 768
     max  sequence  length: 500
     hidden            dim: 200
     filter           nums: 64
     idcnn            nums: 2
     CUDA  VISIBLE  DEVICE: 0
     seed                 : 42
 ++++++++++++++++++++++++++++++++++++++++
 Training Settings:
     epoch                : 300
     batch            size: 8
     dropout              : 0.5
     learning         rate: 0.001
     optimizer            : Adam
     use               gan: False
     gan            method: fgm
     checkpoint       name: model
     max       checkpoints: 3
     print       per_batch: 20
     is     early     stop: True
     patient              : 5
++++++++++++++++++++++++++++++++++++++++CONFIGURATION SUMMARY END++++++++++++++++++++++++++++++++++++++++
loading vocab...
dataManager initialed...
mode: train
loading data...
validating set is not exist, built...
training set size: 298, validating set size: 34
++++++++++++++++++++training starting++++++++++++++++++++
epoch:1/300
training batch:    20, loss: 66.39342, precision: 0.354 recall: 0.270 f1: 0.306 accuracy: 0.818 
start evaluate engines...
label: Symptom, precision: 0.754 recall: 0.860 f1: 0.802 
label: Physiology, precision: 0.253 recall: 0.260 f1: 0.256 
label: Status, precision: 0.722 recall: 0.349 f1: 0.467 
label: Property, precision: 0.000 recall: 0.000 f1: 0.000 
label: Body, precision: 0.000 recall: 0.000 f1: 0.000 
label: Value, precision: 0.000 recall: 0.000 f1: 0.000 
time consumption:2.21(min), precision: 0.666 recall: 0.532 f1: 0.591 accuracy: 0.931 
saved the new best model with f1: 0.591
epoch:2/300
training batch:    20, loss: 23.66320, precision: 0.769 recall: 0.649 f1: 0.704 accuracy: 0.931 
start evaluate engines...
label: Symptom, precision: 0.839 recall: 0.919 f1: 0.875 
label: Physiology, precision: 0.641 recall: 0.670 f1: 0.655 
label: Status, precision: 0.855 recall: 0.760 f1: 0.803 
label: Property, precision: 0.000 recall: 0.000 f1: 0.000 
label: Body, precision: 0.233 recall: 0.253 f1: 0.242 
label: Value, precision: 0.200 recall: 0.100 f1: 0.133 
time consumption:2.04(min), precision: 0.835 recall: 0.812 f1: 0.823 accuracy: 0.962 
saved the new best model with f1: 0.823
epoch:3/300
training batch:    20, loss: 19.17249, precision: 0.800 recall: 0.653 f1: 0.719 accuracy: 0.905 
start evaluate engines...
label: Symptom, precision: 0.903 recall: 0.926 f1: 0.913 
label: Physiology, precision: 0.771 recall: 0.800 f1: 0.785 
label: Status, precision: 0.835 recall: 0.897 f1: 0.864 
label: Property, precision: 0.000 recall: 0.000 f1: 0.000 
label: Body, precision: 0.267 recall: 0.293 f1: 0.279 
label: Value, precision: 0.200 recall: 0.200 f1: 0.200 
time consumption:2.01(min), precision: 0.886 recall: 0.896 f1: 0.891 accuracy: 0.971 
saved the new best model with f1: 0.891
epoch:4/300
training batch:    20, loss: 5.14284, precision: 0.895 recall: 0.829 f1: 0.861 accuracy: 0.962 
start evaluate engines...
label: Symptom, precision: 0.951 recall: 0.957 f1: 0.951 
label: Physiology, precision: 0.771 recall: 0.800 f1: 0.785 
label: Status, precision: 0.849 recall: 0.897 f1: 0.870 
label: Property, precision: 0.200 recall: 0.200 f1: 0.200 
label: Body, precision: 0.800 recall: 0.800 f1: 0.800 
label: Value, precision: 0.200 recall: 0.200 f1: 0.200 
time consumption:2.01(min), precision: 0.922 recall: 0.924 f1: 0.922 accuracy: 0.975 
saved the new best model with f1: 0.922
epoch:5/300
training batch:    20, loss: 7.29264, precision: 0.926 recall: 0.877 f1: 0.901 accuracy: 0.964 
start evaluate engines...
label: Symptom, precision: 0.988 recall: 0.982 f1: 0.984 
label: Physiology, precision: 0.771 recall: 0.800 f1: 0.785 
label: Status, precision: 0.911 recall: 0.897 f1: 0.903 
label: Property, precision: 0.200 recall: 0.200 f1: 0.200 
label: Body, precision: 1.000 recall: 1.000 f1: 1.000 
label: Value, precision: 0.400 recall: 0.400 f1: 0.400 
time consumption:2.00(min), precision: 0.964 recall: 0.952 f1: 0.958 accuracy: 0.984 
saved the new best model with f1: 0.958
epoch:6/300
training batch:    20, loss: 6.65216, precision: 0.923 recall: 0.857 f1: 0.889 accuracy: 0.967 
start evaluate engines...
label: Symptom, precision: 0.951 recall: 0.982 f1: 0.964 
label: Physiology, precision: 0.771 recall: 0.800 f1: 0.785 
label: Status, precision: 0.854 recall: 0.897 f1: 0.874 
label: Property, precision: 0.200 recall: 0.200 f1: 0.200 
label: Body, precision: 1.000 recall: 1.000 f1: 1.000 
label: Value, precision: 0.400 recall: 0.400 f1: 0.400 
time consumption:1.99(min), precision: 0.934 recall: 0.957 f1: 0.944 accuracy: 0.978 
epoch:7/300
training batch:    20, loss: 1.83917, precision: 1.000 recall: 0.974 f1: 0.987 accuracy: 0.996 
start evaluate engines...
label: Symptom, precision: 0.979 recall: 0.982 f1: 0.980 
label: Physiology, precision: 0.771 recall: 0.800 f1: 0.785 
label: Status, precision: 0.863 recall: 0.897 f1: 0.879 
label: Property, precision: 0.200 recall: 0.200 f1: 0.200 
label: Body, precision: 1.000 recall: 1.000 f1: 1.000 
label: Value, precision: 0.400 recall: 0.400 f1: 0.400 
time consumption:2.00(min), precision: 0.948 recall: 0.957 f1: 0.952 accuracy: 0.980 
epoch:8/300
training batch:    20, loss: 1.42455, precision: 0.952 recall: 1.000 f1: 0.976 accuracy: 0.995 
start evaluate engines...
label: Symptom, precision: 0.979 recall: 0.982 f1: 0.980 
label: Physiology, precision: 0.771 recall: 0.800 f1: 0.785 
label: Status, precision: 0.863 recall: 0.897 f1: 0.879 
label: Property, precision: 0.200 recall: 0.200 f1: 0.200 
label: Body, precision: 1.000 recall: 1.000 f1: 1.000 
label: Value, precision: 0.400 recall: 0.400 f1: 0.400 
time consumption:2.02(min), precision: 0.948 recall: 0.957 f1: 0.952 accuracy: 0.980 
epoch:9/300
training batch:    20, loss: 5.52865, precision: 0.945 recall: 0.929 f1: 0.937 accuracy: 0.976 
start evaluate engines...
label: Symptom, precision: 0.988 recall: 0.982 f1: 0.984 
label: Physiology, precision: 0.771 recall: 0.800 f1: 0.785 
label: Status, precision: 0.863 recall: 0.897 f1: 0.879 
label: Property, precision: 0.200 recall: 0.200 f1: 0.200 
label: Body, precision: 1.000 recall: 1.000 f1: 1.000 
label: Value, precision: 0.400 recall: 0.400 f1: 0.400 
time consumption:2.41(min), precision: 0.952 recall: 0.957 f1: 0.954 accuracy: 0.982 
epoch:10/300
training batch:    20, loss: 3.84182, precision: 0.971 recall: 0.971 f1: 0.971 accuracy: 0.982 
start evaluate engines...
label: Symptom, precision: 0.988 recall: 0.982 f1: 0.984 
label: Physiology, precision: 0.738 recall: 0.800 f1: 0.766 
label: Status, precision: 0.879 recall: 0.917 f1: 0.897 
label: Property, precision: 0.200 recall: 0.200 f1: 0.200 
label: Body, precision: 1.000 recall: 1.000 f1: 1.000 
label: Value, precision: 0.400 recall: 0.400 f1: 0.400 
time consumption:2.84(min), precision: 0.960 recall: 0.970 f1: 0.965 accuracy: 0.982 
saved the new best model with f1: 0.965
epoch:11/300
training batch:    20, loss: 0.35033, precision: 1.000 recall: 1.000 f1: 1.000 accuracy: 1.000 
start evaluate engines...
label: Symptom, precision: 0.979 recall: 0.982 f1: 0.980 
label: Physiology, precision: 0.771 recall: 0.800 f1: 0.785 
label: Status, precision: 0.867 recall: 0.912 f1: 0.888 
label: Property, precision: 0.200 recall: 0.200 f1: 0.200 
label: Body, precision: 1.000 recall: 1.000 f1: 1.000 
label: Value, precision: 0.400 recall: 0.400 f1: 0.400 
time consumption:2.75(min), precision: 0.944 recall: 0.954 f1: 0.948 accuracy: 0.982 
epoch:12/300
training batch:    20, loss: 3.26146, precision: 0.938 recall: 0.968 f1: 0.953 accuracy: 0.986 
start evaluate engines...
label: Symptom, precision: 0.988 recall: 1.000 f1: 0.994 
label: Physiology, precision: 0.738 recall: 0.800 f1: 0.766 
label: Status, precision: 0.904 recall: 0.937 f1: 0.919 
label: Property, precision: 0.200 recall: 0.200 f1: 0.200 
label: Body, precision: 1.000 recall: 1.000 f1: 1.000 
label: Value, precision: 0.400 recall: 0.400 f1: 0.400 
time consumption:2.72(min), precision: 0.963 recall: 0.970 f1: 0.966 accuracy: 0.980 
saved the new best model with f1: 0.966
epoch:13/300
training batch:    20, loss: 1.04762, precision: 1.000 recall: 0.939 f1: 0.969 accuracy: 0.998 
start evaluate engines...
label: Symptom, precision: 0.988 recall: 1.000 f1: 0.994 
label: Physiology, precision: 0.714 recall: 0.800 f1: 0.751 
label: Status, precision: 0.928 recall: 0.952 f1: 0.940 
label: Property, precision: 0.200 recall: 0.200 f1: 0.200 
label: Body, precision: 1.000 recall: 1.000 f1: 1.000 
label: Value, precision: 0.400 recall: 0.400 f1: 0.400 
time consumption:2.75(min), precision: 0.958 recall: 0.975 f1: 0.966 accuracy: 0.982 
saved the new best model with f1: 0.966
epoch:14/300
training batch:    20, loss: 1.72816, precision: 0.875 recall: 0.875 f1: 0.875 accuracy: 0.986 
start evaluate engines...
label: Symptom, precision: 0.988 recall: 1.000 f1: 0.994 
label: Physiology, precision: 0.800 recall: 0.800 f1: 0.800 
label: Status, precision: 0.897 recall: 0.897 f1: 0.894 
label: Property, precision: 0.200 recall: 0.200 f1: 0.200 
label: Body, precision: 1.000 recall: 1.000 f1: 1.000 
label: Value, precision: 0.400 recall: 0.400 f1: 0.400 
time consumption:3.06(min), precision: 0.971 recall: 0.956 f1: 0.963 accuracy: 0.981 
epoch:15/300
training batch:    20, loss: 2.34872, precision: 0.921 recall: 0.983 f1: 0.951 accuracy: 0.980 
start evaluate engines...
label: Symptom, precision: 1.000 recall: 1.000 f1: 1.000 
label: Physiology, precision: 0.714 recall: 0.800 f1: 0.751 
label: Status, precision: 0.938 recall: 0.949 f1: 0.942 
label: Property, precision: 0.200 recall: 0.200 f1: 0.200 
label: Body, precision: 1.000 recall: 1.000 f1: 1.000 
label: Value, precision: 0.400 recall: 0.400 f1: 0.400 
time consumption:3.09(min), precision: 0.954 recall: 0.970 f1: 0.962 accuracy: 0.985 
epoch:16/300
training batch:    20, loss: 2.96423, precision: 0.905 recall: 0.884 f1: 0.894 accuracy: 0.975 
start evaluate engines...
label: Symptom, precision: 0.979 recall: 1.000 f1: 0.989 
label: Physiology, precision: 0.714 recall: 0.800 f1: 0.751 
label: Status, precision: 0.926 recall: 0.937 f1: 0.931 
label: Property, precision: 0.200 recall: 0.200 f1: 0.200 
label: Body, precision: 1.000 recall: 1.000 f1: 1.000 
label: Value, precision: 0.400 recall: 0.400 f1: 0.400 
time consumption:2.93(min), precision: 0.954 recall: 0.970 f1: 0.962 accuracy: 0.981 
epoch:17/300
training batch:    20, loss: 4.15651, precision: 0.944 recall: 0.944 f1: 0.944 accuracy: 0.972 
start evaluate engines...
label: Symptom, precision: 0.988 recall: 1.000 f1: 0.994 
label: Physiology, precision: 0.714 recall: 0.800 f1: 0.751 
label: Status, precision: 0.928 recall: 0.952 f1: 0.940 
label: Property, precision: 0.200 recall: 0.200 f1: 0.200 
label: Body, precision: 1.000 recall: 1.000 f1: 1.000 
label: Value, precision: 0.400 recall: 0.400 f1: 0.400 
time consumption:2.74(min), precision: 0.958 recall: 0.975 f1: 0.966 accuracy: 0.985 
epoch:18/300
training batch:    20, loss: 1.38471, precision: 0.964 recall: 0.982 f1: 0.973 accuracy: 0.994 
start evaluate engines...
label: Symptom, precision: 0.988 recall: 1.000 f1: 0.994 
label: Physiology, precision: 0.771 recall: 0.800 f1: 0.785 
label: Status, precision: 0.897 recall: 0.897 f1: 0.894 
label: Property, precision: 0.200 recall: 0.200 f1: 0.200 
label: Body, precision: 1.000 recall: 1.000 f1: 1.000 
label: Value, precision: 0.400 recall: 0.400 f1: 0.400 
time consumption:2.92(min), precision: 0.967 recall: 0.956 f1: 0.961 accuracy: 0.981 
early stopped, no progress obtained within 5 epochs
overall best f1 is 0.966123531640773 at 13 epoch
total training time consumption: 44.505(min)
